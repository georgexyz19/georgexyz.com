<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="/theme/css/bs4min.css">
    <link rel="shortcut icon" type="image/x-icon" href="/theme/images/favicon.ico" >
    <link rel="icon" type="image/x-icon" href="/theme/images/favicon.ico" >
<link rel="stylesheet" href="https://www.georgexyz.com/theme/css/friendly.css">
<link rel="stylesheet" href="https://www.georgexyz.com/theme/css/custom.css">
<meta name="author" content="George Zhang" />
<meta name="keywords" content="python,inkscape" />
<meta name="description" content="At-A-Glance DayMinder Monthly Planner 7” x 8-3/4” Version had been my calendar for a few years. Then I found the excellent PDF software PDFXChange-Viewer and I started downloading monthly …" />
    <title>Python Code To Generate Full Size Yearly Calendar in Inkscape - George Zhang</title>
  </head>
  <body>
    <!-- navbar -->
    <nav class="navbar navbar-expand-md navbar-light" style="background-color: #e3f2fd;">
      <div class="container">
        <a class="navbar-brand" href="/">George Zhang</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarColor01" aria-controls="navbarColor01" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarColor01">
          <ul class="navbar-nav mr-auto">
            <li class="nav-item">
              <a class="nav-link " 
                href="/articlelist.html">Articles</a>
            </li>
            <li class="nav-item">
              <a class="nav-link pr-3 " 
                href="/tags.html">Tags</a>
            </li>
            <li class="nav-item">
              <a class="nav-link pr-3 "
                 href="/pages/inkscape-tutorial.html">Inkscape Tutorial</a>
            </li>
            <li class="nav-item">
                <a class="nav-link "
                   href="/pages/projects.html">Projects</a>
              </li>
          </ul>

          <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link " 
                 href="/pages/about.html">About</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

   

<div class="container">

  <div class="row">
    <div class="col-lg-8 mx-auto">

      <h2>Python Code To Generate Full Size Yearly Calendar in&nbsp;Inkscape</h2>

      <div class="text-muted mb-2">
        <span>Posted on </span>
        <time datetime="2019-04-12 14:06:00-04:00">
          Friday, 04/12/2019 14:06
        </time>

        <span>with tags: </span>
        <a href="https://www.georgexyz.com/tag/python.html">python</a>
/        <a href="https://www.georgexyz.com/tag/inkscape.html">inkscape</a>
      </div>

      <p>At-A-Glance DayMinder Monthly Planner 7&#8221; x 8-3/4&#8221; Version had been my calendar 
for a few years.  Then I found the excellent <span class="caps">PDF</span> software 
<a href="https://www.georgexyz.com/pdfxchange-viewer.html">PDFXChange-Viewer</a> 
and I started downloading monthly <span class="caps">PDF</span> calendars from 
<a href="https://www.timeanddate.com/calendar/create.html">timeanddate.com</a>. 
Each file was for one year, it had 13 pages.  The first page was a yearly 
calendar and other 12 pages were monthly calendars.  I marked events on the <span class="caps">PDF</span> 
directly with 10 point &#8220;Narrow Arial&#8221; fonts. This continued for 
a few&nbsp;years. </p>
<p>After I became familiar with Inkscape extension and Python programming, I 
wrote a python program which generates full size (36&#8221; x 24&#8221;) one page yearly calendar
in Inkscape. I save both <span class="caps">SVG</span> and <span class="caps">PDF</span>&nbsp;files. </p>
<p>Now the one page <span class="caps">PDF</span> file is my daily calendar, and I mark events on the <span class="caps">PDF</span>. 
My event descriptions are usually very short like &#8220;9am meeting with Don&#8221;, 
&#8220;10:45 See Dr Jeff&#8221;, and &#8220;off work vacation in <span class="caps">FL</span>&#8221; </p>
<p>Here is what the yearly calendar looks&nbsp;like. </p>
<div style="max-width:800px">
  <img class="img-fluid" src="/images/img-calendar-2019.svg" alt="calendar example"> 
</div>

<p>Here are the links for calendars from 2019 to 2025.  I will add more links to this page 
in year&nbsp;2025.</p>
<ul>
<li>2019: <a href="/files/calendar/2019.svg">svg</a> <a href="/files/calendar/2019.pdf">pdf</a></li>
<li>2020: <a href="/files/calendar/2020.svg">svg</a> <a href="/files/calendar/2020.pdf">pdf</a></li>
<li>2021: <a href="/files/calendar/2021.svg">svg</a> <a href="/files/calendar/2021.pdf">pdf</a></li>
<li>2022: <a href="/files/calendar/2022.svg">svg</a> <a href="/files/calendar/2022.pdf">pdf</a></li>
<li>2023: <a href="/files/calendar/2023.svg">svg</a> <a href="/files/calendar/2023.pdf">pdf</a></li>
<li>2024: <a href="/files/calendar/2024.svg">svg</a> <a href="/files/calendar/2024.pdf">pdf</a></li>
<li>2025: <a href="/files/calendar/2025.svg">svg</a> <a href="/files/calendar/2025.pdf">pdf</a></li>
</ul>
<p>Here are the code in create_calendar.inx and create_calendar.py&nbsp;files. </p>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="nt">&lt;inkscape-extension</span> <span class="na">xmlns=</span><span class="s">&quot;http://www.inkscape.org/namespace/inkscape/extension&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;_name&gt;</span>Create Calendar<span class="nt">&lt;/_name&gt;</span>
  <span class="nt">&lt;id&gt;</span>create_calendar.com.gotrafficsign<span class="nt">&lt;/id&gt;</span>
  <span class="nt">&lt;dependency</span> <span class="na">type=</span><span class="s">&quot;executable&quot;</span> <span class="na">location=</span><span class="s">&quot;extensions&quot;</span><span class="nt">&gt;</span>inkex.py<span class="nt">&lt;/dependency&gt;</span>
  <span class="nt">&lt;dependency</span> <span class="na">type=</span><span class="s">&quot;executable&quot;</span> <span class="na">location=</span><span class="s">&quot;extensions&quot;</span><span class="nt">&gt;</span>simplestyle.py<span class="nt">&lt;/dependency&gt;</span>
  <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">&quot;yearNumber&quot;</span> <span class="na">type=</span><span class="s">&quot;int&quot;</span> <span class="na">min=</span><span class="s">&quot;0&quot;</span> <span class="na">max=</span><span class="s">&quot;2100&quot;</span> <span class="na">gui-text=</span><span class="s">&quot;For Year: &quot;</span><span class="nt">&gt;</span>2019<span class="nt">&lt;/param&gt;</span>

  <span class="nt">&lt;effect&gt;</span>
    <span class="nt">&lt;object-type&gt;</span>all<span class="nt">&lt;/object-type&gt;</span>
    <span class="nt">&lt;effects-menu&gt;</span>
      <span class="nt">&lt;submenu</span> <span class="na">_name=</span><span class="s">&quot;OpenCalendar&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;/submenu&gt;</span>
    <span class="nt">&lt;/effects-menu&gt;</span>
  <span class="nt">&lt;/effect&gt;</span>

  <span class="nt">&lt;script&gt;</span>
    <span class="nt">&lt;command</span> <span class="na">reldir=</span><span class="s">&quot;extensions&quot;</span> <span class="na">interpreter=</span><span class="s">&quot;python&quot;</span><span class="nt">&gt;</span>create_calendar.py<span class="nt">&lt;/command&gt;</span>
  <span class="nt">&lt;/script&gt;</span>

<span class="nt">&lt;/inkscape-extension&gt;</span>
</code></pre></div>


<div class="highlight"><pre><span></span><code><span class="ch">#! /usr/bin/python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd"># create_calendar.py</span>
<span class="sd">Create post size calendar file in Inkscape</span>

<span class="sd">Copyright (C) December 08 2018 George Zhang</span>

<span class="sd">This program is free software; you can redistribute it and/or modify</span>
<span class="sd">it under the terms of the GNU General Public License as published by</span>
<span class="sd">the Free Software Foundation; either version 2 of the License, or</span>
<span class="sd">(at your option) any later version.</span>

<span class="sd">This program is distributed in the hope that it will be useful,</span>
<span class="sd">but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="sd">MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="sd">GNU General Public License for more details.</span>

<span class="sd">You should have received a copy of the GNU General Public License</span>
<span class="sd">along with this program; if not, write to the Free Software</span>
<span class="sd">Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">inkex</span>
<span class="kn">import</span> <span class="nn">simplestyle</span>
<span class="kn">import</span> <span class="nn">simpletransform</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">calendar</span>
<span class="kn">import</span> <span class="nn">logging</span>

<span class="k">class</span> <span class="nc">CreateCalendar</span><span class="p">(</span><span class="n">inkex</span><span class="o">.</span><span class="n">Effect</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">inkex</span><span class="o">.</span><span class="n">Effect</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">OptionParser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span>
            <span class="s2">&quot;--yearNumber&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;int&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s2">&quot;yearN&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>

        <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;logging.txt&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">effect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">PAGE_W</span> <span class="o">=</span> <span class="mi">36</span>
        <span class="n">PAGE_H</span> <span class="o">=</span> <span class="mi">24</span>

        <span class="n">w</span> <span class="o">=</span> <span class="n">PAGE_W</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">PAGE_H</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">change_SVG_size</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>

        <span class="n">year</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">yearN</span>
        <span class="n">month</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">width</span> <span class="o">=</span> <span class="mi">9</span>
        <span class="n">height</span> <span class="o">=</span> <span class="mi">8</span>

        <span class="n">i</span> <span class="o">=</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">):</span>
            <span class="n">i</span> <span class="o">=</span> <span class="p">(</span><span class="n">month</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">4</span>
            <span class="n">j</span> <span class="o">=</span> <span class="p">(</span><span class="n">month</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">4</span> <span class="c1"># python 2 only</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">9</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">j</span> <span class="o">*</span> <span class="mi">8</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">draw_month</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">change_SVG_size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">):</span>
        <span class="n">ratio</span> <span class="o">=</span> <span class="mf">25.4</span>
        <span class="n">svg_elem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">document</span><span class="o">.</span><span class="n">getroot</span><span class="p">()</span>

        <span class="n">page_width</span> <span class="o">=</span> <span class="n">width</span>
        <span class="n">page_height</span> <span class="o">=</span> <span class="n">height</span>

        <span class="n">svg_elem</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;width&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">page_width</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;in&#39;</span><span class="p">)</span>
        <span class="n">svg_elem</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">page_height</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;in&#39;</span><span class="p">)</span>
        <span class="n">svg_elem</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;viewBox&#39;</span><span class="p">,</span> <span class="s1">&#39;0 0 &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">page_width</span> <span class="o">*</span> <span class="n">ratio</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span>
                     <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">page_height</span> <span class="o">*</span> <span class="n">ratio</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">draw_SVG_line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">),</span> <span class="n">style</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;style is a dict&#39;&#39;&#39;</span>
        <span class="n">line_attribs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="n">simplestyle</span><span class="o">.</span><span class="n">formatStyle</span><span class="p">(</span><span class="n">style</span><span class="p">),</span>
                        <span class="n">inkex</span><span class="o">.</span><span class="n">addNS</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="s1">&#39;inkscape&#39;</span><span class="p">):</span> <span class="n">name</span><span class="p">,</span>
                        <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="s1">&#39;M &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">y1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; L&#39;</span> <span class="o">+</span>
                        <span class="nb">str</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">y2</span><span class="p">)}</span>
        <span class="n">elm</span> <span class="o">=</span> <span class="n">inkex</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span>
            <span class="n">parent</span><span class="p">,</span> <span class="n">inkex</span><span class="o">.</span><span class="n">addNS</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">,</span> <span class="s1">&#39;svg&#39;</span><span class="p">),</span> <span class="n">line_attribs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">elm</span>

    <span class="k">def</span> <span class="nf">draw_lines</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">):</span>
        <span class="n">line_style</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;stroke&#39;</span><span class="p">:</span> <span class="s1">&#39;#000000&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;stroke-width&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unittouu</span><span class="p">(</span><span class="s1">&#39;1px&#39;</span><span class="p">)),</span>
                      <span class="s1">&#39;fill&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">}</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
            <span class="n">x1_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="mi">9</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;in&#39;</span>
            <span class="n">y1_str</span> <span class="o">=</span> <span class="s1">&#39;0.25in&#39;</span>
            <span class="n">y2_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">height</span> <span class="o">-</span> <span class="mf">0.25</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;in&#39;</span>
            <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">unittouu</span><span class="p">,</span> <span class="p">[</span><span class="n">x1_str</span><span class="p">,</span> <span class="n">x1_str</span><span class="p">,</span> <span class="n">y1_str</span><span class="p">,</span> <span class="n">y2_str</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">draw_SVG_line</span><span class="p">((</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">),</span> <span class="n">line_style</span><span class="p">,</span> <span class="s1">&#39;line&#39;</span><span class="p">,</span> <span class="n">layer</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
            <span class="n">x1_str</span> <span class="o">=</span> <span class="s1">&#39;0.25in&#39;</span>
            <span class="n">x2_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">width</span> <span class="o">-</span> <span class="mf">0.25</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;in&#39;</span>
            <span class="n">y1_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="mi">8</span> <span class="o">*</span> <span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;in&#39;</span>
            <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">unittouu</span><span class="p">,</span> <span class="p">[</span><span class="n">x1_str</span><span class="p">,</span> <span class="n">x2_str</span><span class="p">,</span> <span class="n">y1_str</span><span class="p">,</span> <span class="n">y1_str</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">draw_SVG_line</span><span class="p">((</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">),</span> <span class="n">line_style</span><span class="p">,</span> <span class="s1">&#39;line&#39;</span><span class="p">,</span> <span class="n">layer</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">draw_grid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">num_col</span><span class="p">,</span> <span class="n">num_row</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;width and height, in in inches, same for x and y&#39;&#39;&#39;</span>
        <span class="n">line_style</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;stroke&#39;</span><span class="p">:</span> <span class="s1">&#39;#000000&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;stroke-width&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unittouu</span><span class="p">(</span><span class="s1">&#39;1px&#39;</span><span class="p">)),</span>
                      <span class="s1">&#39;fill&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">}</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_col</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">x1_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">width</span><span class="p">)</span><span class="o">/</span><span class="n">num_col</span><span class="p">)</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;in&#39;</span>
            <span class="n">x2_str</span> <span class="o">=</span> <span class="n">x1_str</span>
            <span class="n">y1_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;in&#39;</span>
            <span class="n">y2_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="n">height</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;in&#39;</span>
            <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">unittouu</span><span class="p">,</span> <span class="p">[</span><span class="n">x1_str</span><span class="p">,</span> <span class="n">x2_str</span><span class="p">,</span> <span class="n">y1_str</span><span class="p">,</span> <span class="n">y2_str</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">draw_SVG_line</span><span class="p">((</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">),</span> <span class="n">line_style</span><span class="p">,</span> <span class="s1">&#39;line&#39;</span><span class="p">,</span> <span class="n">layer</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_row</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">x1_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;in&#39;</span>
            <span class="n">x2_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">width</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;in&#39;</span>
            <span class="n">y1_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">height</span><span class="p">)</span><span class="o">/</span><span class="n">num_row</span><span class="p">)</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;in&#39;</span>
            <span class="n">y2_str</span> <span class="o">=</span> <span class="n">y1_str</span>
            <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">unittouu</span><span class="p">,</span> <span class="p">[</span><span class="n">x1_str</span><span class="p">,</span> <span class="n">x2_str</span><span class="p">,</span> <span class="n">y1_str</span><span class="p">,</span> <span class="n">y2_str</span><span class="p">])</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x1_str</span><span class="p">,</span> <span class="n">x2_str</span><span class="p">,</span> <span class="n">y1_str</span><span class="p">,</span> <span class="n">y2_str</span><span class="p">))</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">draw_SVG_line</span><span class="p">((</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">),</span> <span class="n">line_style</span><span class="p">,</span> <span class="s1">&#39;line&#39;</span><span class="p">,</span> <span class="n">layer</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">draw_month</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;height and width in inches int</span>
<span class="sd">        x and y in inches from top left corner&#39;&#39;&#39;</span>
        <span class="c1"># num_col = 7</span>
        <span class="c1"># num_row = 5</span>
        <span class="n">cal</span> <span class="o">=</span> <span class="n">calendar</span><span class="o">.</span><span class="n">Calendar</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="c1"># set Sunday as first day</span>

        <span class="n">width</span> <span class="o">=</span> <span class="n">width</span> <span class="o">-</span> <span class="mf">0.4</span>
        <span class="n">height</span> <span class="o">=</span> <span class="n">height</span> <span class="o">-</span> <span class="mf">0.4</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mf">0.2</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="mf">0.2</span>

        <span class="c1"># assert num_row in (4, 5, 6), &quot;num of row should be 4 5 or 6&quot;</span>
        <span class="c1"># width_col = float(width) / num_col</span>
        <span class="c1"># height_row = float(height) / num_row</span>

        <span class="n">x_month</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="nb">float</span><span class="p">(</span><span class="n">width</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">y_month</span> <span class="o">=</span> <span class="n">y</span>
        <span class="n">ratio</span> <span class="o">=</span> <span class="mf">25.4</span>
        <span class="n">x_month_R</span><span class="p">,</span> <span class="n">y_month_R</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_month</span> <span class="o">*</span> <span class="n">ratio</span><span class="p">,</span> <span class="n">y_month</span> <span class="o">*</span> <span class="n">ratio</span><span class="p">)</span>

        <span class="n">y_month_R</span> <span class="o">+=</span> <span class="mf">9.15</span> <span class="o">+</span> <span class="mi">7</span> <span class="c1"># 7 from observation</span>
        <span class="n">text_layer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_create_layer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">document</span><span class="o">.</span><span class="n">getroot</span><span class="p">(),</span>
            <span class="s1">&#39;text_layer&#39;</span><span class="p">)</span>
        <span class="n">elem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_month_text</span><span class="p">(</span><span class="n">x_month_R</span><span class="p">,</span> <span class="n">y_month_R</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">year</span><span class="p">)</span>
        <span class="n">text_layer</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>

        <span class="n">x_dayofweek</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="nb">float</span><span class="p">(</span><span class="n">width</span><span class="p">)</span> <span class="o">/</span> <span class="mf">7.0</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">y_dayofweek</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="mf">1.35</span>
        <span class="n">x_dayofweek_R</span><span class="p">,</span> <span class="n">y_dayofweek_R</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_dayofweek</span> <span class="o">*</span> <span class="n">ratio</span><span class="p">,</span>
            <span class="n">y_dayofweek</span> <span class="o">*</span> <span class="n">ratio</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">):</span>
            <span class="n">elem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw_weekday_text</span><span class="p">(</span><span class="n">x_dayofweek_R</span><span class="p">,</span> <span class="n">y_dayofweek_R</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
            <span class="n">text_layer</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
            <span class="n">x_dayofweek_R</span> <span class="o">+=</span> <span class="nb">float</span><span class="p">(</span><span class="n">width</span><span class="p">)</span> <span class="o">/</span> <span class="mf">7.0</span> <span class="o">*</span> <span class="n">ratio</span>

        <span class="n">bk_layer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_create_layer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">document</span><span class="o">.</span><span class="n">getroot</span><span class="p">(),</span> <span class="s1">&#39;bk_layer&#39;</span><span class="p">)</span>

        <span class="n">num_col</span> <span class="o">=</span> <span class="mi">7</span>
        <span class="n">num_row</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cal</span><span class="o">.</span><span class="n">monthdayscalendar</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">draw_grid</span><span class="p">(</span><span class="n">bk_layer</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">-</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">num_col</span><span class="p">,</span> <span class="n">num_row</span><span class="p">,</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">+</span><span class="mf">1.5</span><span class="p">)</span>

        <span class="n">cal_matrix</span> <span class="o">=</span> <span class="n">cal</span><span class="o">.</span><span class="n">monthdayscalendar</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_row</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_col</span><span class="p">):</span>
                <span class="n">day_num</span> <span class="o">=</span> <span class="n">cal_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">day_num</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">draw_text</span><span class="p">(</span><span class="n">text_layer</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">-</span> <span class="mf">1.5</span><span class="p">,</span>
                        <span class="n">num_col</span><span class="p">,</span> <span class="n">num_row</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">+</span><span class="mf">1.5</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">day_num</span><span class="p">),</span> <span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">draw_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">num_col</span><span class="p">,</span> <span class="n">num_row</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>
        <span class="n">name</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;place day number in a monthly grid&#39;&#39;&#39;</span>

        <span class="n">x_loc</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">width</span><span class="p">)</span><span class="o">/</span><span class="n">num_col</span><span class="p">)</span> <span class="o">*</span> <span class="n">i</span>
        <span class="n">y_loc</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">height</span><span class="p">)</span><span class="o">/</span><span class="n">num_row</span><span class="p">)</span> <span class="o">*</span> <span class="n">j</span> <span class="c1"># top left corner</span>

        <span class="n">ratio</span> <span class="o">=</span> <span class="mf">25.4</span>

        <span class="n">x_loc_R</span> <span class="o">=</span> <span class="n">x_loc</span> <span class="o">*</span> <span class="n">ratio</span>
        <span class="n">y_loc_R</span> <span class="o">=</span> <span class="n">y_loc</span> <span class="o">*</span> <span class="n">ratio</span>

        <span class="n">y_loc_R</span> <span class="o">+=</span> <span class="mf">6.097</span>  <span class="c1"># vertical adjustement, vertical align baseline</span>

        <span class="n">x_loc_R</span> <span class="o">+=</span> <span class="mi">2</span>
        <span class="n">y_loc_R</span> <span class="o">+=</span> <span class="mi">2</span>  <span class="c1"># second adjustment</span>

        <span class="n">elem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_text</span><span class="p">(</span><span class="n">x_loc_R</span><span class="p">,</span> <span class="n">y_loc_R</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">layer</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">create_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>

        <span class="n">style_d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;font-size&#39;</span><span class="p">:</span> <span class="s1">&#39;6.34px&#39;</span><span class="p">,</span>  <span class="c1"># 18 pt</span>
                   <span class="s1">&#39;font-family&#39;</span><span class="p">:</span> <span class="s1">&#39;Roboto&#39;</span><span class="p">,</span>
                   <span class="c1">#   &#39;text-align&#39;: &#39;center&#39;,</span>
                   <span class="s1">&#39;text-anchor&#39;</span><span class="p">:</span> <span class="s1">&#39;start&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;fill&#39;</span><span class="p">:</span> <span class="s1">&#39;#000000&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;stroke&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span>
                   <span class="p">}</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">inkex</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">inkex</span><span class="o">.</span><span class="n">addNS</span><span class="p">(</span><span class="s1">&#39;space&#39;</span><span class="p">,</span> <span class="s1">&#39;xml&#39;</span><span class="p">),</span> <span class="s1">&#39;preserve&#39;</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">t</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
        <span class="n">t</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;style&#39;</span><span class="p">,</span> <span class="n">simplestyle</span><span class="o">.</span><span class="n">formatStyle</span><span class="p">(</span><span class="n">style_d</span><span class="p">))</span>

        <span class="n">sp</span> <span class="o">=</span> <span class="n">inkex</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="s1">&#39;tspan&#39;</span><span class="p">)</span>
        <span class="n">sp</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">inkex</span><span class="o">.</span><span class="n">addNS</span><span class="p">(</span><span class="s1">&#39;role&#39;</span><span class="p">,</span> <span class="s1">&#39;sodipodi&#39;</span><span class="p">),</span> <span class="s1">&#39;line&#39;</span><span class="p">)</span>
        <span class="n">sp</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">name</span>
        <span class="k">return</span> <span class="n">t</span>

    <span class="k">def</span> <span class="nf">draw_month_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">year</span><span class="p">):</span>
        <span class="n">month_name_str</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;January&#39;</span><span class="p">,</span> <span class="s1">&#39;February&#39;</span><span class="p">,</span> <span class="s1">&#39;March&#39;</span><span class="p">,</span> <span class="s1">&#39;April&#39;</span><span class="p">,</span>
            <span class="s1">&#39;May&#39;</span><span class="p">,</span> <span class="s1">&#39;June&#39;</span><span class="p">,</span> <span class="s1">&#39;July&#39;</span><span class="p">,</span> <span class="s1">&#39;August&#39;</span><span class="p">,</span>
            <span class="s1">&#39;September&#39;</span><span class="p">,</span> <span class="s1">&#39;October&#39;</span><span class="p">,</span> <span class="s1">&#39;November&#39;</span><span class="p">,</span> <span class="s1">&#39;December&#39;</span><span class="p">]</span>

        <span class="n">style_d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;font-size&#39;</span><span class="p">:</span> <span class="s1">&#39;12.69px&#39;</span><span class="p">,</span>  <span class="c1"># 24 pt</span>
                   <span class="s1">&#39;font-family&#39;</span><span class="p">:</span> <span class="s1">&#39;Roboto&#39;</span><span class="p">,</span>
                   <span class="c1">#&#39;text-align&#39;: &#39;center&#39;,</span>
                   <span class="s1">&#39;text-anchor&#39;</span><span class="p">:</span> <span class="s1">&#39;middle&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;fill&#39;</span><span class="p">:</span> <span class="s1">&#39;#000000&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;stroke&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span>
                   <span class="p">}</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">inkex</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">inkex</span><span class="o">.</span><span class="n">addNS</span><span class="p">(</span><span class="s1">&#39;space&#39;</span><span class="p">,</span> <span class="s1">&#39;xml&#39;</span><span class="p">),</span> <span class="s1">&#39;preserve&#39;</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">t</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
        <span class="n">t</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;style&#39;</span><span class="p">,</span> <span class="n">simplestyle</span><span class="o">.</span><span class="n">formatStyle</span><span class="p">(</span><span class="n">style_d</span><span class="p">))</span>

        <span class="n">sp</span> <span class="o">=</span> <span class="n">inkex</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="s1">&#39;tspan&#39;</span><span class="p">)</span>
        <span class="n">sp</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">inkex</span><span class="o">.</span><span class="n">addNS</span><span class="p">(</span><span class="s1">&#39;role&#39;</span><span class="p">,</span> <span class="s1">&#39;sodipodi&#39;</span><span class="p">),</span> <span class="s1">&#39;line&#39;</span><span class="p">)</span>
        <span class="n">sp</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">month_name_str</span><span class="p">[</span><span class="n">month</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">t</span>

    <span class="k">def</span> <span class="nf">draw_weekday_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">dayofweek</span><span class="p">):</span>
        <span class="n">dayofweek_str</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Sunday&#39;</span><span class="p">,</span> <span class="s1">&#39;Monday&#39;</span><span class="p">,</span> <span class="s1">&#39;Tuesday&#39;</span><span class="p">,</span> <span class="s1">&#39;Wednesday&#39;</span><span class="p">,</span>
            <span class="s1">&#39;Thursday&#39;</span><span class="p">,</span> <span class="s1">&#39;Friday&#39;</span><span class="p">,</span> <span class="s1">&#39;Saturday&#39;</span> <span class="p">]</span>

        <span class="n">style_d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;font-size&#39;</span><span class="p">:</span> <span class="s1">&#39;8.46px&#39;</span><span class="p">,</span>  <span class="c1"># 24 pt</span>
                   <span class="s1">&#39;font-family&#39;</span><span class="p">:</span> <span class="s1">&#39;Roboto&#39;</span><span class="p">,</span>
                   <span class="c1">#&#39;text-align&#39;: &#39;center&#39;,</span>
                   <span class="s1">&#39;text-anchor&#39;</span><span class="p">:</span> <span class="s1">&#39;middle&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;fill&#39;</span><span class="p">:</span> <span class="s1">&#39;#000000&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;stroke&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span>
                   <span class="p">}</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">inkex</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">inkex</span><span class="o">.</span><span class="n">addNS</span><span class="p">(</span><span class="s1">&#39;space&#39;</span><span class="p">,</span> <span class="s1">&#39;xml&#39;</span><span class="p">),</span> <span class="s1">&#39;preserve&#39;</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">t</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
        <span class="n">t</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;style&#39;</span><span class="p">,</span> <span class="n">simplestyle</span><span class="o">.</span><span class="n">formatStyle</span><span class="p">(</span><span class="n">style_d</span><span class="p">))</span>

        <span class="n">sp</span> <span class="o">=</span> <span class="n">inkex</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="s1">&#39;tspan&#39;</span><span class="p">)</span>
        <span class="n">sp</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">inkex</span><span class="o">.</span><span class="n">addNS</span><span class="p">(</span><span class="s1">&#39;role&#39;</span><span class="p">,</span> <span class="s1">&#39;sodipodi&#39;</span><span class="p">),</span> <span class="s1">&#39;line&#39;</span><span class="p">)</span>
        <span class="n">sp</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">dayofweek_str</span><span class="p">[</span><span class="n">dayofweek</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">t</span>

    <span class="k">def</span> <span class="nf">find_create_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">layer_name</span><span class="p">):</span>
        <span class="c1"># this should not be svg:g</span>
        <span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;//g[@inkscape:label=&quot;</span><span class="si">%s</span><span class="s1">&quot;]&#39;</span> <span class="o">%</span> <span class="n">layer_name</span>
        <span class="n">path</span> <span class="o">+=</span> <span class="s1">&#39;|//svg:g[@inkscape:label=&quot;</span><span class="si">%s</span><span class="s1">&quot;]&#39;</span> <span class="o">%</span> <span class="n">layer_name</span>
        <span class="n">el_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">document</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">namespaces</span><span class="o">=</span><span class="n">inkex</span><span class="o">.</span><span class="n">NSS</span><span class="p">)</span>
        <span class="c1"># inkex.debug(el_list)</span>
        <span class="k">if</span> <span class="n">el_list</span><span class="p">:</span>
            <span class="n">layer</span> <span class="o">=</span> <span class="n">el_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="c1">#inkex.debug(&#39;this code never execute, why?&#39;)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">layer</span> <span class="o">=</span> <span class="n">inkex</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">)</span>
            <span class="n">layer</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">inkex</span><span class="o">.</span><span class="n">addNS</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="s1">&#39;inkscape&#39;</span><span class="p">),</span> <span class="n">layer_name</span><span class="p">)</span>
            <span class="n">layer</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">inkex</span><span class="o">.</span><span class="n">addNS</span><span class="p">(</span><span class="s1">&#39;groupmode&#39;</span><span class="p">,</span> <span class="s1">&#39;inkscape&#39;</span><span class="p">),</span> <span class="s1">&#39;layer&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">layer</span>

    <span class="k">def</span> <span class="nf">create_group</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">group_name</span><span class="p">):</span>
        <span class="n">group</span> <span class="o">=</span> <span class="n">inkex</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
        <span class="n">group</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">inkex</span><span class="o">.</span><span class="n">addNS</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="s1">&#39;inkscape&#39;</span><span class="p">),</span> <span class="n">group_name</span><span class="p">)</span>
        <span class="n">group</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;fill&#39;</span><span class="p">,</span> <span class="s1">&#39;none&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">group</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">CreateCalendar</span><span class="p">()</span>
    <span class="n">e</span><span class="o">.</span><span class="n">affect</span><span class="p">()</span>
</code></pre></div>



    </div>
  </div>

</div>

   
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
  </body>
</html>